"use strict";(self.webpackChunkwarehouse_docs=self.webpackChunkwarehouse_docs||[]).push([[5653],{7779:(e,t,s)=>{s.d(t,{p:()=>le});var n=s(5073),a=s(2023),o=s(8862),r=s(7294),i=s(7297),l=s(377),c=s(552),d=s(1265),u=s(2430);const h="container_sJQR",m="column_jT0P";var x=s(5893);const g=e=>(0,x.jsxs)("div",{className:h,children:[(0,x.jsx)(o.Z,{variant:"h6",textAlign:"center",children:e.title}),(0,x.jsx)("div",{style:{backgroundColor:e.color,height:"3px",marginBottom:"5px"}}),(0,x.jsx)("div",{className:m,children:e.children})]});var p=s(892),v=s(9417),j=s(8262),C=s(5819),k=s(1167),b=s.n(k),y=s(7918),f=s(1222);const _=(e,t,s)=>Math.min(Math.max(e,t),s),Z=function(e,t,s){void 0===t&&(t=100),void 0===s&&(s=100);let n=0,a=0,o=0;4==e.length?(n="0x"+e[1]+e[1],a="0x"+e[2]+e[2],o="0x"+e[3]+e[3]):7==e.length&&(n="0x"+e[1]+e[2],a="0x"+e[3]+e[4],o="0x"+e[5]+e[6]),n/=255,a/=255,o/=255;let r=Math.min(n,a,o),i=Math.max(n,a,o),l=i-r,c=0,d=0,u=0;return c=0==l?0:i==n?(a-o)/l%6:i==a?(o-n)/l+2:(n-a)/l+4,c=Math.round(60*c),c<0&&(c+=360),u=(i+r)/2,d=0==l?0:l/(1-Math.abs(2*u-1)),d=+(100*d).toFixed(1),u=+(100*u).toFixed(1),d=_(d,0,t),u=_(u,0,s),"hsl("+c+","+d+"%,"+u+"%)"};var w=s(5687),N=s.n(w);const S="container__pwk",T=e=>{let{tags:t,setTags:s,editMode:n}=e;const[a,o]=(0,r.useState)(!1),i=(0,r.useCallback)(((e,t)=>e.map(((e,s)=>(0,x.jsx)(y.Z,{label:e,size:"small",sx:{backgroundColor:Z(N()(e),80,30)},...t({index:s})},e)))),[]);return n?(0,x.jsx)("div",{className:S,children:(0,x.jsx)(f.Z,{multiple:!0,size:"small",freeSolo:!0,options:[],value:t,onChange:(e,t)=>{s(t),o(!1)},fullWidth:!0,renderTags:i,renderInput:e=>(0,x.jsx)(p.Z,{...e,placeholder:"Tags",onChange:e=>o(""!==e.target.value),helperText:a?"Press enter to confirm tags":void 0})})}):i(t,(()=>{}))};const M=s(6809).default.customFields.FEEDBACK_API_URL,E=function(e,t,s){return void 0===t&&(t=void 0),void 0===s&&(s=3),M?fetch(`https://5993-212-115-157-45.ngrok-free.app/api/v1/${e}`,{method:t?"POST":"GET",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({...t,service:"warehouse"})}).then((e=>e.json())).catch((n=>(console.log(n),s>0?E(e,t,s-1):{ok:!1}))):(console.log("FEEDBACK_API_URL not defined"),{ok:!1})},U="row_ZYmh",A="container_wiGJ",D="contentContainer_hTOi",z="commentsContainer_HyNH",B="comments_w7rT",F="commentsScroll_rpyb",P="commentContainer__EUJ",O="commentHeader_gCoZ",W="commentContent_qtHZ",$="editorContainer_TlsY",L="markdownEditor_uEf9",I="markdownPreview_rCEM",H="buttonContainer_bYiZ",R="editorCommentContainer_vTd1",J=function(e,t,s){void 0===t&&(t=-1),void 0===s&&(s=0);const n=(new Date).getTime()/1e3;let a=Math.round(n-e),o=1===a?"second ago":"seconds ago",r=0;return a>60&&(a=Math.round(a/60),o=1===a?"minute ago":"minutes ago",r=1),1===r&&a>60&&(a=Math.round(a/60),o=1===a?"hour ago":"hours ago",r=2),2===r&&a>23&&(a=Math.round(a/24),o=1===a?"day ago":"days ago",r=3),t>=0&&r===t&&a>s?(a=new Date(1e3*e).toLocaleString(),o=""):o=` ${o}`,`${a}${o}`},G=(e,t)=>e.created<t.created?-1:1,Y=e=>{const t=(0,r.useRef)(),[s,i]=(0,r.useState)(!1),[c,d]=(0,r.useState)(""),[u,h]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[k,y]=(0,r.useState)([]),[f,_]=(0,r.useState)("todo"),{enqueueSnackbar:Z}=(0,l.Ds)(),{service:w,kind:N,isAdmin:S,forceUpdate:M}=e,{created:Y,user:q,content:K,comments:Q}=e.entry||{};if((0,r.useEffect)((()=>{e.open&&(e.entry?.id?i(!1):i(!0))}),[e.open,e.entry]),(0,r.useEffect)((()=>{e.open&&(d(K?.title||""),h(K?.description||""),y(e.entry.tags||[]),_(e.entry.status||"todo"))}),[e.entry]),!e.open)return null;const V=!e.entry?.id,X=J(Y,3,1),ee={"& .MuiDialog-container":{"& .MuiPaper-root":{height:V?"50vh":"80vh",backgroundColor:"rgb(25, 25, 25)",backgroundImage:"none"}}},te=q&&e.reader.username===q.username,se=e.columns.find((e=>e.status===f)),ne=()=>{const t={service:w,kind:N,post_id:e.entry.id,user:e.reader,content:m};E("create_comment",t).then((e=>{e.ok||Z("There was an issue posting your comment :(",{variant:"error"}),M()})),g("")};return(0,x.jsx)(j.Z,{open:e.open,fullWidth:!0,maxWidth:"lg",onClose:e.onClose,sx:ee,children:(0,x.jsxs)("div",{className:A,children:[s?(0,x.jsx)(p.Z,{placeholder:"Title",fullWidth:!0,size:"small",value:c,onChange:e=>d(e.target.value)}):(0,x.jsx)(o.Z,{variant:"h6",children:c}),!V&&(0,x.jsxs)(o.Z,{color:"grey",children:[X," by ",q?.name||"Unknown"]}),(0,x.jsxs)("div",{className:U,children:[S&&s?(0,x.jsx)(p.Z,{placeholder:"Status",size:"small",select:!0,sx:{minWidth:150},value:f,onChange:e=>_(e.target.value),children:e.columns.map((e=>(0,x.jsx)(C.Z,{value:e.status,children:e.title},e.status)))}):(0,x.jsx)(o.Z,{sx:{minWidth:"max-content",color:se.colour},children:se.title}),(0,x.jsx)(T,{tags:k,setTags:y,editMode:s})]}),(0,x.jsx)("div",{className:D,children:(0,x.jsx)("div",{"data-color-mode":"dark",className:`editor-container ${$}`,children:(0,x.jsx)(b(),{ref:t,readOnly:!s,className:s?L:I,theme:"bubble",bounds:".editor-container",value:u,placeholder:"Description",onChange:h})})}),(0,x.jsxs)("div",{className:z,children:[!V&&(0,x.jsx)(o.Z,{variant:"h6",children:Q&&Q.length>0?"Comments":"No comments"}),V?null:(0,x.jsxs)("div",{className:B,children:[(0,x.jsx)("div",{className:F,children:(0,x.jsx)(n.M,{mode:"popLayout",children:Q.sort(G).map(((e,t)=>(0,x.jsxs)(a.E.div,{className:P,layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[(0,x.jsx)("div",{className:O,children:(0,x.jsxs)(o.Z,{color:"darkgrey",children:[J(e.created,3,1)," by ",e.user.name||"Unknown"]})}),(0,x.jsx)("div",{"data-color-mode":"dark",className:`editor-container ${W}`,children:(0,x.jsx)(b(),{readOnly:!0,theme:"bubble",value:e.content})})]},e.id)))})}),(0,x.jsxs)("div",{"data-color-mode":"dark",className:`editor-container ${R}`,children:[(0,x.jsx)(b(),{ref:t,className:L,theme:"bubble",bounds:".editor-container",value:m,placeholder:"New Comment",onChange:g}),(0,x.jsx)(v.Z,{disabled:!m,onClick:ne,variant:"outlined",color:"success",sx:{margin:"auto"},children:"Post Comment"})]})]})]}),(0,x.jsxs)("div",{className:H,children:[(0,x.jsx)(v.Z,{color:"secondary",variant:"outlined",size:"small",onClick:e.onClose,children:"Close"}),V&&(0,x.jsx)(v.Z,{color:"success",variant:"outlined",size:"small",onClick:()=>{const t={kind:N,service:w,user:e.reader,status:f,tags:k,content:{title:c,description:u}};E("create_post",t).then((e=>{e.ok?Z("Feedback created!",{variant:"success"}):Z("There was an issue creating your post :(",{variant:"error"}),M()})),e.onClose(),d(""),h("")},children:"Create"}),(S||te)&&!V&&s&&(0,x.jsx)(v.Z,{color:"success",variant:"outlined",size:"small",onClick:()=>{const t={post_id:e.entry.id,kind:N,service:w,status:f,user:e.reader,tags:k,content:{title:c,description:u}};E("update_post",t).then((e=>{e.ok?(Z("Updated!",{variant:"success"}),i(!1),M()):Z("There was an issue updating this post",{variant:"error"})}))},children:"Update"}),(S||te)&&!V&&!s&&(0,x.jsx)(v.Z,{color:"success",variant:"outlined",size:"small",onClick:()=>i(!0),children:"Edit"})]})]})})};var q=s(517),K=s(3946),Q=s(4603),V=s(9369);const X={container:"container_UjmF",contentContainer:"contentContainer_MS_x",bottomBar:"bottomBar_BsbR",tagsContainer:"tagsContainer_gAnW",bottomButtonsContainer:"bottomButtonsContainer_GDZc",row:"row_w2OQ"},ee=e=>{const[t,s]=(0,r.useState)(0),[n,a]=(0,r.useState)(null),{service:i,kind:c,data:d,onClick:u,forceUpdate:h,reader:m,columns:g,isAdmin:p}=e,{user:v,content:j,comments:k,tags:f,created:_}=d;(0,r.useEffect)((()=>{if(!_)return;const e=(new Date).getTime()/1e3,t=(e=>{switch(!0){case e<60:return 5e3;case e<3600:return 6e4;case e<86400:return 36e5;default:return-1}})(Math.round(e-_)),n=setTimeout((()=>{t>0&&s((e=>e+1))}),t);return()=>{clearTimeout(n)}}),[t,d]);const w=J(_,3,1);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(q.Z,{MenuListProps:{style:{padding:"4px 0"}},anchorEl:n,open:null!==n,onClose:()=>a(null),children:[g.filter((e=>e.status!==d.status)).map((e=>(0,x.jsx)(C.Z,{onClick:()=>(e=>{const t={service:i,kind:c,post_id:d.id,status:e,user:m};E("update_post",t).then((e=>{e.ok||(0,l.yv)("There was an issue changing the status of this post",{variant:"error"}),h()})),a(null)})(e.status),children:e.title},e.status))),(0,x.jsx)(C.Z,{onClick:t=>{const s={service:i,kind:c,post_id:d.id,user:e.reader};E("delete_post",s).then((()=>h())),a(null)},children:"Delete"},"delete")]}),(0,x.jsxs)("div",{className:X.container,onClick:u,children:[(0,x.jsx)(o.Z,{variant:"h6",className:X.title,sx:{textOverflow:"ellipsis",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:"2",WebkitBoxOrient:"vertical"},children:j?.title}),(0,x.jsx)("div",{className:X.contentContainer,children:(0,x.jsx)(b(),{readOnly:!0,value:j?.description,theme:"bubble",className:"cursor-pointer shorten"})}),(0,x.jsxs)(o.Z,{color:"grey",children:[w," by ",v.name]}),(0,x.jsxs)("div",{className:X.bottomBar,children:[(0,x.jsx)("div",{className:X.tagsContainer,children:f.map((e=>(0,x.jsx)(y.Z,{label:e,size:"small",sx:{backgroundColor:Z(N()(e),80,30)}},e)))}),(0,x.jsxs)("div",{className:X.bottomButtonsContainer,children:[(0,x.jsx)(o.Z,{color:"grey",children:k?.length}),(0,x.jsx)(Q.Z,{sx:{color:"grey"}}),p&&(0,x.jsx)(K.Z,{onClick:e=>{e.stopPropagation(),a(e.currentTarget)},size:"small",sx:{p:0},children:(0,x.jsx)(V.Z,{sx:{color:"grey"}})})]})]})]})]})};var te=s(1202);const se="container_Uv13",ne="row__hdr",ae="newContainer_LzxO",oe=(0,d.Z)({palette:{mode:"dark",lightgrey:{main:"rgb(200,200,200)"}},typography:{allVariants:{color:"lightgrey"}}}),re=[{status:"todo",title:"Not Started",colour:"rgb(40, 85, 184)"},{status:"doing",title:"In Progress",colour:"rgb(44, 185, 44)"},{status:"testing",title:"Testing",colour:"rgb(185, 48, 48)"},{status:"done",title:"Done",colour:"rgb(27, 172, 128)"}],ie=(e,t)=>e.created>t.created?-1:1,le=e=>{let{service:t,kind:s,title:d}=e;const[h,m]=(0,r.useState)(""),[p,v]=(0,r.useState)([]),[j,C]=(0,r.useState)({}),[k,b]=(0,r.useState)([]),[y,f]=(0,r.useState)(0);(0,r.useEffect)((()=>{if(j.name&&j.address)return;const e=localStorage.getItem(`${t}User`);if(!e)return void C({});const s=(0,te.o)(e);s.name&&s.email?(s.username=s.email.split("@")[0],C(s)):console.log("Failed to parse user data",e)}),[]),(0,r.useEffect)((()=>{E("get_admins",{service:t}).then((e=>{b(e?.data?[...e.data,"george"]:["george"])}))}),[]),(0,r.useEffect)((()=>{E("get_posts",{service:t,kind:s}).then((e=>{v(e?.data?e.data.sort(ie):[])}))}),[y]);const _=(0,r.useMemo)((()=>h&&p.find((e=>e.id===h))||{})),Z=k.includes(j.username);return(0,x.jsxs)(u.Z,{theme:oe,children:[(0,x.jsx)(i.Z,{styles:{...(0,c.Z)()}}),(0,x.jsx)(l.wT,{autoHideDuration:3e3,maxSnack:3,children:(0,x.jsxs)("div",{className:se,children:[(0,x.jsx)(Y,{service:t,kind:s,reader:j,columns:re,entry:_,open:!!h,onClose:()=>m(""),setData:v,isAdmin:Z,forceUpdate:()=>f((e=>e+1))}),(0,x.jsx)(o.Z,{variant:"h4",textAlign:"center",children:d}),(0,x.jsx)("div",{className:ne,children:re.map((e=>(0,x.jsxs)(g,{title:e.title,color:e.colour,children:["todo"===e.status?(0,x.jsx)("div",{className:ae,onClick:()=>m("new"),children:(0,x.jsx)(o.Z,{variant:"h5",textAlign:"center",children:"Create"})},`${e.status}-new`):null,(0,x.jsx)(n.M,{mode:"popLayout",children:p.filter((t=>t.status===e.status)).map((e=>(0,x.jsx)(a.E.div,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,x.jsx)(ee,{service:t,kind:s,data:e,reader:j,onClick:()=>m(e.id),forceUpdate:()=>f((e=>e+1)),columns:re,isAdmin:Z})},e.id)))})]},e.status)))})]})})]})}},9511:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(1262),a=s(5893);const o=e=>(0,a.jsx)(n.Z,{children:()=>{const t=s(7779).p;return(0,a.jsx)(t,{...e})}})},2741:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});var n=s(9511),a=s(3258),o=s(5893);const r=()=>(0,o.jsx)(a.Z,{title:"Feedback",children:(0,o.jsx)(n.Z,{service:"warehouse",kind:"rfe",title:"Feedback"})})}}]);